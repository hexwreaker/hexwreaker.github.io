<!DOCTYPE html>
<html lang="en">
<head class="page-header" role="banner">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexwreaker Expoitpedia</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <canvas id="container"></canvas>
    <script src="/script.js"></script>

    <div id="main" class="main-content" role="main">
        <div id="nav-bar">
            <div id="nav-home" class="nav-item"><a href="/"><img src="/src/images/home.jpg"/></a></div>
        </div>
        <h4 id="exploitpedia"><a href="/pages/exploitpedia/exploitpedia">ExploitPedia</a></h4>

<h1 id="c-vtables">C++ VTables</h1>

<h2 id="présentation">Présentation</h2>

<p>Le langage C++ permet de créer et manipuler des “objets”. C’est une foncitonnalité que l’on ne retrouve pas en C. La COO du langage implémente l’héritage entre un objet parent et un objet fils.</p>

<p>Les VTables (virtual tables)sont utilisées lors de l’héritage enter objet, afin que le fils puisse accéder à la fonction virtuelle du parent. Si une classe hérite d’une classe parente qui possède des fonctions virtuelles, alors la résolution devient dynamique et une VTable est utilisée.</p>

<h4 id="exploitation">Exploitation</h4>

<p>L’exploitation consiste à remplacer l’adresse <strong>m_pformatter</strong> par une adresse vers une zone mémoire que l’attaquant contrôle, à savoir le buffer <strong>str</strong>. Comme l’ASLR est désactivé, l’exploitation est très facile.</p>

<p>Dans le buffer, l’attaquant place une “VTable simulée” qui contient l’adresse vers le shellcode.</p>

<p>Lors de la résolution d’adresse, la VTable utilisée ne sera plus celle de l’objet mais une VTable forgée par l’attaquant. La fonction appelée sera le shellcode.</p>


    </div>
</body>
</html>
