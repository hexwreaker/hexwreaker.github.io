<!DOCTYPE html>
<html lang="en">
<head class="page-header" role="banner">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hexwreaker Expoitpedia</title>
    <link rel="stylesheet" href="/style.css">
</head>
<body>
    <canvas id="container"></canvas>
    <script src="/script.js"></script>

    <div id="main" class="main-content" role="main">
        <div id="nav-bar">
            <div id="nav-home" class="nav-item"><a href="/"><img src="/src/images/home.jpg"/></a></div>
        </div>
        <h4 id="exploitpedia"><a href="/pages/exploitpedia/exploitpedia">ExploitPedia</a></h4>

<h1 id="format-strings-overflow">Format strings overflow</h1>

<h2 id="présentation">Présentation</h2>

<p>Les <strong>Format strings</strong> représente une catégorie entière de vulnérabilités, spécifique aux fonctions de la <strong>libc</strong>, qui formatte les chaînes de caractères à savoir : <strong>printf</strong>, <strong>snprintf</strong>, …</p>

<p>Lorsqu’une format string est présente l’attaquant peut lire et modifier la mémoire, avec plus ou moins de facilités dépendemment du cas de figure.</p>

<h2 id="exemple-">Exemple :</h2>

<p>La format string se trouve dans l’utilisation de la fonction <strong>sprintf</strong> lors de la copie de <strong>buffer</strong> vers <strong>output</strong>. Il est possible d’écrire un <strong>format</strong> dans <strong>buffer</strong> qui sera interprété.
Seulement le nombre de caractères qu’il est possible d’écrire est limité à 11. L’attaquant ne peut donc pas utilisé le format <strong>“%hn”</strong> pour écrire et remplacer <strong>eip</strong>.</p>

<p>La solution est d’utiliser le format <strong>“%Nx”</strong> où <strong>N</strong> est un nombre de caractères qui sera rajouté dans le buffer <strong>output</strong> par <strong>sprintf</strong>. L’usage de ce format est d’afficher un nombre avec un padding d’espaces de sorte que la taille de l’affichage du nombre ne dépasse pas <strong>N</strong>.
Cela permet de déborder dans la mémoire est d’écrire une adresse après le nombre affiché.</p>

<p>Le shellcode peut être injecter en mémoire avec un argument. Il est aussi possible de l’injecter dans une variable d’environnement.
L’adresse du shellcode est connu car l’ASLR est désactivé.</p>

    </div>
</body>
</html>
