---
layout: default
title: Hexwreaker Expoitpedia
---
#### [ExploitPedia](/pages/exploitpedia/exploitpedia)

# ROP-x86

    Cible : x86 32bit

## Présentation

La technique du ROP (Return Oriented Programming) consiste à se servir de "gadgets" présents dans le binaire afin de contrôler le flot d'exécution du processus.
Les gadgets sont assemblés dans une "Ropchain" et sont utilisés par les instructions **ret**, successivement.

Le ROP permet de controuner l'**ASLR** et le **NX** (W xor X).


Le buffer overflow permet à l'attaquant de réecrire l'adresse de retour de **main**, seulement. Il doit donc contrôler une seconde zone mémoire afin d'y placer sa **ropchain**.

Une technique appelée **"stack pivoting"** est nécessaire afin que l'attaquant puisse écrire toute la ropchain dans le buffer global **name**. En effet, ce buffer n'est pas assez grand opur contenir la ropchain complète.
Le **stack pivoting** consiste à controler la **stack frame** du processus afin d'appeler à plusieurs reprises la fonction **read**. 
Elle s'appuie sur le double appel à l'instruction **"leave ; ret"**, ce qui permet de contrôler les valeurs des registres **rbp** et **rsp**.

Grâce à cette technique l'attaquant peut assembler la ropchain en plusieurs fois. Voir : https://ir0nstone.gitbook.io/notes/binexp/stack/stack-pivoting

Voici la ropchain finale qui assemble la ropchain en mémoire et contrôle la stack frame avec les instructions **leave** et **ret**.
