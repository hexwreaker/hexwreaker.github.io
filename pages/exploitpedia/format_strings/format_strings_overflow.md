---
layout: default
title: Hexwreaker Expoitpedia
---
#### [ExploitPedia](/pages/exploitpedia/exploitpedia)

# Format strings overflow
	
## Présentation

Les **Format strings** représente une catégorie entière de vulnérabilités, spécifique aux fonctions de la **libc**, qui formatte les chaînes de caractères à savoir : **printf**, **snprintf**, ...

Lorsqu'une format string est présente l'attaquant peut lire et modifier la mémoire, avec plus ou moins de facilités dépendemment du cas de figure.

## Exemple :


La format string se trouve dans l'utilisation de la fonction **sprintf** lors de la copie de **buffer** vers **output**. Il est possible d'écrire un **format** dans **buffer** qui sera interprété.
Seulement le nombre de caractères qu'il est possible d'écrire est limité à 11. L'attaquant ne peut donc pas utilisé le format **"%hn"** pour écrire et remplacer **eip**.

La solution est d'utiliser le format **"%Nx"** où **N** est un nombre de caractères qui sera rajouté dans le buffer **output** par **sprintf**. L'usage de ce format est d'afficher un nombre avec un padding d'espaces de sorte que la taille de l'affichage du nombre ne dépasse pas **N**.
Cela permet de déborder dans la mémoire est d'écrire une adresse après le nombre affiché.

Le shellcode peut être injecter en mémoire avec un argument. Il est aussi possible de l'injecter dans une variable d'environnement.
L'adresse du shellcode est connu car l'ASLR est désactivé.